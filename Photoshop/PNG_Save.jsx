//#target photoshop;if (app.documents.length > 0) {var thedoc = app.activeDocument;// getting the name and location;var docName = thedoc.name;if (docName.indexOf(".") != -1) {var basename = docName.match(/(.*)\.[^\.]+$/)[1]}else {var basename = docName};// getting the location, if unsaved save to desktop;try {var docPath = thedoc.path}catch (e) {var docPath = ""};// create folder if it does not exist;var folderString = docPath+"/"+"PNG";if (Folder(folderString).exists == false) {new Folder(folderString).create()}; // psd options;pngOpts = new PNGSaveOptions();pngOpts.compression = 9;  pngOpts.interlaced = false;thedoc.saveAs((new File(folderString+"/"+basename+".png")),pngOpts,true);};